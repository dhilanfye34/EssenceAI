{% extends "base.html" %}

{% block title %}{{ cancer_type }}{% endblock %}

{% block content %}
<div class="cancer-info">
    <h1>{{ cancer_type }}</h1>
    <h2>Description</h2>
    <p>{{ description }}</p>

    <h2>Facts</h2>
    <ul>
        {% for fact in facts %}
        <li>{{ fact }}</li>
        {% endfor %}
    </ul>

    <h2>Related Articles</h2>
    <ul>
        {% for article in articles %}
        <li>      
                {{ article.title }} 
        </li>
        {% endfor %}
    </ul>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Fetch articles asynchronously after page loads
        fetch(`/api/fetch_articles/{{ cancer_type | urlencode }}`)
            .then(response => response.json())
            .then(data => {
                // Clear existing placeholder content
                const articlesList = document.getElementById("articles-list");
                articlesList.innerHTML = '';
    
                // Populate articles dynamically
                data.forEach(article => {
                    const listItem = document.createElement("li");
                    listItem.innerHTML = `<strong>${article.title}</strong>: ${article.summary}`;
                    articlesList.appendChild(listItem);
                });
            })
            .catch(error => {
                console.error("Error fetching articles:", error);
                document.getElementById("articles-list").innerHTML = '<li>Failed to load articles.</li>';
            });
    });
    </script>
{% endblock %}